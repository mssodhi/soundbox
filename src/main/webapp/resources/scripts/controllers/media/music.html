<div ng-init="ctrl.init()" class="col-md-9">

    <div class="col-md-12">
        <div class="search-bar">
            <p>Powered by <b>SoundCloud</b></p>
            <input type="text" placeholder="Search for an artist" class="col-md-3" ng-model="ctrl.search" ng-model-options="{debounce: 250}" ng-change="ctrl.getArtist()">
            <a class="ml15" href="" ng-if="!ctrl.showInitList && ctrl.tracks.length > 0" ng-click="ctrl.init()">All music</a>
            <br>
        </div>
        <br>
    </div>

    <br>

    <!-- Message when the there's a technical error -->
    <div ng-if="ctrl.tracks.length < ctrl.artist.track_count && !ctrl.showInitList" class="col-md-12">
        <div class="card card-red">
            <div class="panel-body">
                <p>Unexpected error occurred fetching tracks for {{ctrl.artist.full_name}}</p>
            </div>
        </div>
    </div>

    <!-- Message when the user doesn't have any tracks -->
    <div ng-if="ctrl.artist.track_count === 0" class="col-md-12">
        <div class="card card-red">
            <div class="panel-body">
                <p>No tracks by {{ctrl.artist.full_name}}</p>
            </div>
        </div>
    </div>


    <!-- Artists search query list -->
    <div ng-if="ctrl.artists.length > 0 && ctrl.showArtists" class="repeated-item" ng-repeat="artist in ctrl.artists track by $index">
        <div class="col-md-4" ng-if="artist.full_name" title="{{artist.full_name}}">
            <div class="col-md-12 card card-red button card-sc" ng-click="ctrl.setArtist(artist)">
                <div class="panel-body text-center">
                    <img ng-src="{{artist.avatar_url}}">
                    <span ng-if="artist.avatar_url === null"><img height="100px" width="100px" src="resources/images/noImage.jpg"></span>
                    <h6 class="custom-font" style="color: gray"><a ng-href="{{artist.permalink_url}}" target="_blank">
                        {{artist.full_name | limitTo: 70}}</a><span ng-if="artist.full_name > 70"> . . . </span></h6>
                    <h3>
                        <label class="label label-info" ng-if="artist.track_count > 0">{{artist.track_count | number}} tracks</label>
                        <label class="label label-danger" ng-if="artist.track_count === 0">{{artist.track_count}} tracks</label>
                        <a class="btn btn-success" ng-click="ctrl.addFavorite(artist)" ng-if="!ctrl.isFavorite(artist)">Add Favorite</a>
                        <a class="btn btn-primary" ng-if="ctrl.isFavorite(artist)">Favorite Artist</a>
                    </h3>

                </div>
            </div>
        </div>
    </div>

    <!-- Initial songs list by all favorites -->
    <div ng-if="ctrl.tracks.length > 0 && ctrl.showInitList" class="col-md-12">
        <span class="pull-left"><b>Total {{ctrl.tracks.length}} tracks</b></span>
        <span class="pull-right">Filter <input type="text" placeholder="e.g. track, artist, plays" ng-model="search"></span>

        <table class="col-md-12 table mt15">
            <thead>
            <tr>
                <th ng-click="ctrl.sort('title')" class="button">Title <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('artist')" class="button">Artist <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('plays')" class="button">Plays <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('favorites')" class="button">Favorites <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('duration')" class="button">Duration <i class="fa fa-sort"></i></th>
                <!--<th ng-click="ctrl.sort('date')" class="button">Date <i class="fa fa-sort"></i></th>-->
            </tr>
            </thead>
            <tbody ng-repeat="track in ctrl.tracks | filter: search" title="{{track.title}}">
            <tr class="button" ng-class="ctrl.isPlaying(track)" ng-click="ctrl.select(track)">
                <td>
                    <img ng-if="track.artwork_url !== null" class="track-image" ng-src="{{track.artwork_url}}">
                    <img ng-if="track.artwork_url === null" class="track-image" src="resources/images/noImage.jpg">
                    <a>{{track.title | limitTo: 40}}<span ng-if="track.title.length > 40">... </span></a>
                </td>
                <td style="vertical-align: middle"><a ng-href="{{track.user.permalink_url}}" target="_blank">{{track.user.username}}</a></td>
                <td style="vertical-align: middle">{{track.playback_count | number}}</td>
                <td style="vertical-align: middle"><span class="fa fa-heart"></span> {{track.favoritings_count | number}}</td>
                <td style="vertical-align: middle">{{ctrl.milliToTime(track.duration)}}</td>
                <!--<td style="vertical-align: middle">{{ctrl.getDate(track.created_at)}}</td>-->
            </tr>

            </tbody>
        </table>

    </div>

    <!-- The actual songs list by user -->
    <div ng-if="ctrl.tracks.length > 0 && !ctrl.showArtists && ctrl.artist && !ctrl.showInitList" class="col-md-12">

        <div class="mb10 card-sc panel-body card card-purple col-md-8" style="min-height: 132px">
            <div class="col-md-12 mb5">
                <span style="font-size: large" class="custom-font"><a ng-href="{{ctrl.artist.permalink_url}}" target="_blank">{{ctrl.artist.full_name}}</a></span>
                <span class="fa fa-2x fa-plus-circle button" ng-click="ctrl.addFavorite(ctrl.artist)" ng-if="!ctrl.isFavorite(ctrl.artist)"></span><br>
            </div>

            <div class="col-md-1 mr15">
                <img ng-src="{{ctrl.artist.avatar_url}}" style="height: 100px; width: 100px; display: inline-block">
                <img ng-if="ctrl.artist.artwork_url === null" height="100px" width="100px" src="resources/images/noImage.jpg">
            </div>

            <div class="col-md-10 ml15">
                <!--<hr>-->
                <div class="col-md-4 text-center" style="vertical-align: middle">
                    <h5>{{ctrl.artist.followers_count | number}}</h5>
                    <p>Followers</p>
                </div>
                <div class="col-md-4 text-center" style="vertical-align: middle">
                    <h5>{{ctrl.artist.followings_count | number}}</h5>
                    <p>Following</p>
                </div>
                <div class="col-md-4 text-center" style="vertical-align: middle">
                    <h5>{{ctrl.artist.track_count | number}}</h5>
                    <p>Tracks</p>
                </div>
            </div>

            <div class="col-md-10 ml15 text-center">
                <div class="col-md-12">
                    <a ng-href="{{ctrl.artist.permalink_url}}" target="_blank">{{ctrl.artist.permalink_url}}</a>
                </div>
            </div>
        </div>

        <span class="pull-right">Filter <input type="text" placeholder="e.g. track, plays, etc." ng-model="search"></span>

        <table class="col-md-12 mt15 table">
            <thead>
            <tr>
                <th ng-click="ctrl.sort('title')" class="button">Title <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('plays')" class="button">Plays <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('favorites')" class="button">Favorites <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('duration')" class="button">Duration <i class="fa fa-sort"></i></th>
                <th ng-click="ctrl.sort('date')" class="button">Date <i class="fa fa-sort"></i></th>
            </tr>
            </thead>
            <tbody ng-repeat="track in ctrl.tracks | filter: search" title="{{track.title}}">
            <tr class="button" ng-class="ctrl.isPlaying(track)" ng-click="ctrl.select(track)">
                <td>
                    <img ng-if="track.artwork_url !== null" class="track-image" ng-src="{{track.artwork_url}}">
                    <img ng-if="track.artwork_url === null" class="track-image" src="resources/images/noImage.jpg">
                    <a>{{track.title | limitTo: 50}}<span ng-if="track.title.length > 50">... </span></a>
                </td>
                <td style="vertical-align: middle">{{track.playback_count | number}}</td>
                <td style="vertical-align: middle"><span class="fa fa-heart"></span> {{track.favoritings_count | number}}</td>
                <td style="vertical-align: middle">{{ctrl.milliToTime(track.duration)}}</td>
                <td style="vertical-align: middle">{{ctrl.getDate(track.created_at)}}</td>
            </tr>

            </tbody>
        </table>

    </div>


</div>

<!-- Favorites List on the side -->
<div class="col-md-3">
    <div ng-if="ctrl.favorites.length > 0">
        <div class="card">
            <div class="card-red panel-body">
                <span class="fa fa-star-o"> Favorite Artists</span>
            </div>
            <div class="button hover-under-line" ng-repeat="artist in ctrl.favorites track by $index"
                 ng-click="ctrl.setArtist(artist)">
                <div class="panel-body" title="{{artist.full_name}}">
                    <img ng-src="{{artist.avatar_url}}" style="height: 50px; width: 50px; display: inline-block">
                    <span ng-if="artist.artwork_url === null"><img height="100px" width="100px" src="resources/images/noImage.jpg"></span>
                    {{artist.full_name | limitTo: 70}} <span ng-if="artist.full_name.length > 70"> . . . </span>
                    <a class="fa fa-remove pull-right" style="padding-top: inherit" ng-click="ctrl.removeFavorite(artist)"></a>
                </div>
            </div>
        </div>
    </div>
</div>